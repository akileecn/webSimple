 <!DOCTYPE html>
  <html>
  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="../jquerymobile/css/jquery.mobile-1.4.5.css">
  <style>
  		.col_cv_alt {
		    margin: 0 0 0 5px;
		    text-align: left;
		    font-size: 0.85em;
		    color: #F00;
		}
  </style>
  	<script src="../jquerymobile/js/jquery-1.12.3.min.js"></script>
  	<script src="../jquerymobile/js/jquery.mobile-1.4.5.min.js"></script>
    <script src="../jquerymobile/js/common.js"></script>
  </head>
  <body>
   <div data-role="page" id="pageone">
       <div data-role="header" data-position="fixed">
          <h1>修改密码</h1>
          <a href="#" data-icon="home" onclick="goHome($(this))"  data-iconpos="notext" data-direction="reverse">Home</a>
       </div>
       
       <div data-role="content" style="margin-top:-10px;padding-top:30px;">
           <div align="center"></div>
           <form id="updatePassword"  method="post">
              <input type="password" name="oldPassword" id="oldPassword" placeholder="旧密码">
              	<div class="col_cv_alt" data-error="oldPassword"></div>
              <br>	              
              <input type="password" name="password" id="password" placeholder="新密码">
              	<div class="col_cv_alt" data-error="password"></div>
              <div><font style="color:#daa;padding-left:10px;">6-16位，数字、字母或常用符号，至少包含2种组合</font></div>
              <br>
              <input type="password" name="password2" id="password2" placeholder="重复密码">
              	<div class="col_cv_alt" data-error="password"></div>
              <br>
              <input type="text" name="captcha" placeholder="验证码">
              	<div class="col_cv_alt" data-error="captcha"></div>
              <img style="width:80px;height:40px;" id="captcha" src="">
              <a href="javascript:changeCaptcha();">换一张</a>
           </form>
           <div align="center">
              <a data-role="button" href="#" onclick="submit()">确定</a>
              <a data-role="button" href="#" onclick="toLogin()">取消</a>
           </div>
       </div>
   </div>
   </body>

<script>
$(function(){

	changeCaptcha();   //加载验证码
});
	function submit(){
		$.ajax({
			beforeSend:function(datas){
				var password=$("#updatePassword input[name='password']").val();
				var password2=$("#updatePassword input[name='password2']").val();
				if(password!=password2){
					$('#updatePassword').showError({"password":"新旧密码不一致","password2":"新旧密码不一致"})
					return false;
				}else{
					return true;
				}
			},
			url:baseUrl+"/user/updatePassword",
			data:$("#updatePassword").serialize(),
			type:"post",
			success:function(text){
				if(text.success){
					showDialog({
						head:"提示",
						title:"密码修改成功",
						content:"",
						href:"main.html",
						type:"opens"
					});
				}else{
					changeCaptcha();
					$("#updatePassword").showError(text.error);
				}
			}
		});
	
	}
	
	//换验证码
	function changeCaptcha(){
		$("#captcha").attr("src",baseUrl+"/user/captchaImage.png?r="+Math.random());
	}
	
	function toLogin(){
		window.history.back();
	}
</script>
</html>
