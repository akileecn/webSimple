 <!DOCTYPE html>
  <html>
  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="../jquerymobile/css/jquery.mobile-1.4.5.css">
  <link rel="stylesheet" href="../mobiscroll/mobiscroll.css" >
  <script src="../jquerymobile/js/jquery-1.12.3.min.js"></script>
  <script src="../jquerymobile/js/jquery.mobile-1.4.5.min.js"></script>
  <script src="../jquerymobile/js/jquery.formautofill.min.js"></script>
  <script src="../jquerymobile/js/jquery.ui.widget.js"></script>
  <script src="../jquerymobile/js/jquery.iframe-transport.js"></script>
  <script src="../jquerymobile/js/jquery.fileupload.js"></script>  
  <script src="../cityselect/js/jquery.cityselect.js"></script>
  <script src="../mobiscroll/mobiscroll.js"></script>
  <script src="../jquerymobile/js/common.js"></script>
  	    <script type="text/javascript">

	    	// 初始化插件内容
	    	var opt_data = {
	            preset: 'date', //日期格式 date（日期）|datetime（日期加时间）
	            theme: 'jqm', //皮肤样式
	            display: 'modal', //显示方式
	            mode: 'clickpick', //日期选择模式
	            dateFormat: 'yyyy-mm-dd', // 日期格式
	            setText: '确定', //确认按钮名称
	            cancelText: '取消',//取消按钮名籍我
	            dateOrder: 'yymmdd', //面板中日期排列格式
	            dayText: '日', monthText: '月', yearText: '年', //面板中年月日文字
	            yearText: '年', monthText: '月',  dayText: '日',  //面板中年月日文字
	            endYear:2020, //结束年份
	            showNow:true,
	            nowText:'今天',
	            hourText:'小时',
	            minuteText:'分'
	        };
	    	
	    	// 初始化插件内容
	    	var opt_data_year = {
	            preset: 'date', //日期格式 date（日期）|datetime（日期加时间）
	            theme: 'jqm', //皮肤样式
	            display: 'modal', //显示方式
	            mode: 'clickpick', //日期选择模式
	            dateFormat: 'yyyy', // 日期格式
	            setText: '确定', //确认按钮名称
	            cancelText: '取消',//取消按钮名籍我
	            dateOrder: 'yymmdd', //面板中日期排列格式
	            dayText: '日', monthText: '月', yearText: '年', //面板中年月日文字
	            yearText: '年', monthText: '月',  dayText: '日',  //面板中年月日文字
	            endYear:2020, //结束年份
	            showNow:true,
	            nowText:'今天',
	            hourText:'小时',
	            minuteText:'分'
	        };
	    	
			// 使用定义插件
	        $(document).on("pageinit", "#pageone", function(){
	        	$('.my-date').mobiscroll(opt_data);
	        	$('.my-date-year').mobiscroll(opt_data_year);
	        });

	    </script>	
  <style>
     .clone{
     	display:none;
     }
     .bgc{
     	backgroud-color:red;
     }
     .ui-mobile label, .ui-controlgroup-label{
        margin:0.6em 0 0.2em;
     }
     .ui-mobile label, div.ui-controlgroup-label{
     	font-size:20px;
     	font-family:"Times New Roman",Georgia,Serif;
     }
     .ui-content{
     	padding:0;
     }
     .ui-collapsible-content {
	    padding:0;
	 }
     .col_cv_alt {
	    margin: 0 0 0 5px;
	    text-align: left;
	    font-size: 0.85em;
	    color: #F00;
	 }
	 .selectCity select {
	      width:30%;
	      border-radius:5px;
	      min-height: 2.4em;
	      background: transparent none;
	      text-align:center;
	 }
	 
	 .selectCity .more {
		  margin-top:10px;
	      width:93%;
	      border-radius:5px;
	      min-height: 2.4em;
	 }
	 
	 img {
	    border: #CCC solid 1px;
	    width: 120px;
	    height: 150px;
	 }
	 
	 .img input {
	    width: 120px;
	    height: 150px;
	    position: absolute;
	    opacity: 0;
	    top: 80px;
	    left: 105px;
	    filter: progid:DXImageTransform.Microsoft.Alpha(opacity=0);
	}
  </style>
  </head>
  <body>
   <div data-role="page" id="pageone">
       <div data-role="header" data-position="fixed" data-theme="a">
          <h1 id="recruit_title">我的简历</h1>
          <a href="#" data-icon="home" onclick="goHome($(this))"  data-iconpos="notext" data-direction="reverse">Home</a>
       </div>   
       <div data-role="content" style="margin-top:-10px" >
            <div id="Base" data-role="collapsible">
                <h1>基本信息</h1>
                <fieldset data-role="controlgroup" style="border:solid #ddd 3px;border-radius:10px;padding:0 15px 15px 15px;"> 
 	    	        <form id="baseForm" method="post">
                    <div data-role="fieldcontain">
                      <input id="reusmeId" type="hidden" name="id">
                      <input id="recruitType" type="hidden" name="recruitType">
                      
                      <label>个人照片：</label>
                      <div class="tip_note" data-role="none">点击照片上传，要求JPG格式，不超过50KB</div>
                      <div class="img" align="center" data-role="none">
                        	<img id="photoImg" src="" onerror="" alt="点击上传个人照片" data-role="none"/>
                        	<input id="fileupload" type="file" name="files[]" data-url="" multiple data-role="none"/>
                      </div>
                      
                      <label for="name"><font color="red">* </font>姓名：</label>
                      		<input type="text" name="name" id="name" width="50%">
                      		<div class="col_cv_alt" data-error="name"></div>
                      <label for="gender"><font color="red">* </font>性别:</label>
                      		<select name="gender" id="gender" data-native-menu="true">
							</select>
							<div class="col_cv_alt" data-error="gender"></div>
                      <label for="birthday"><font color="red">* </font>出生日期:</label>
                      		<input type="date" name="birthday" id="birthday">
                      		<div class="col_cv_alt" data-error="birthday"></div>
                      <label for="nation"><font color="red">* </font>民族:</label>
                      		<select name="nation" id="nation" data-native-menu="true">
							</select>
							<div class="col_cv_alt" data-error="nation"></div>
                      <label for="height"><font color="red">* </font>身高(cm)：</label>
                      		<input type="text" name="height" id="height">
                      		<div class="col_cv_alt" data-error="height"></div>
                      <label for="weight"><font color="red">* </font>体重(kg)：</label>
                      		<input type="text" name="weight" id="weight">
                      		<div class="col_cv_alt" data-error="weight"></div>
                      <label for="idNumber"><font color="red">* </font>身份证号码:</label>
                      		<input type="text" name="idNumber" id="idNumber">
                      		<div class="col_cv_alt" data-error="idNumber"></div>
                      <label for="nativePlace"><font color="red">* </font>籍贯:</label>
                      <div class="selectCity">
                      		<select class="prov"  data-role="none"></select> 
							<select class="city"  data-role="none" disabled="disabled"></select>
							<div class="col_cv_alt" data-role="none" data-error="nativePlace"></div>
							<input type="text" data-role="none" name="nativePlace" id="nativePlace" style="display:none;">
                      </div>
                      <label for="registeredResidence"><font color="red">* </font>户口所在地:</label>
                      <div class="selectCity">
                      		<select class="prov" data-role="none"></select> 
							<select class="city" data-role="none" disabled="disabled"></select>
							<div class="col_cv_alt" data-role="none" data-error="registeredResidence"></div>
							<input type="text" data-role="none" name="registeredResidence" id="registeredResidence" style="display:none;">
                      </div>
                      <label for="marriage"><font color="red">* </font>婚姻状况::</label>
                      		<select name="marriage" id="marriage" data-native-menu="true">
							</select>
							<div class="col_cv_alt" data-error="marriage"></div>
                      <label for="lname"><font color="red">* </font>政治面貌：</label>
                      		<select name="politicsStatus" id="politicsStatus" data-native-menu="true">
							</select>
							<div class="col_cv_alt" data-error="politicsStatus"></div>
                      <label for="joinPartyDate">入党(团)时间::</label>
                      		<input type="date" name="joinPartyDate" id="joinPartyDate">
                      		<div class="col_cv_alt" data-error="joinPartyDate"></div>
                      <label for="mobile"><font color="red">* </font>移动电话::</label>
                      		<input type="text" name="mobile" id="mobile">
                      		<div class="col_cv_alt" data-error="mobile"></div>
                      <label for="email"><font color="red">* </font>电子邮箱：</label>
                      		<input type="email" name="email" id="email">
                      		<div class="col_cv_alt" data-error="email"></div>
              <div class="society">        
                      <label for="beginWorkDate"><font color="red">* </font>参加工作时间：</label>
                      		<input type="date" name="beginWorkDate" id="beginWorkDate">
                      		<div class="col_cv_alt" data-error="beginWorkDate"></div>
                      <label for="workYear"><font color="red">* </font>参加工作年限:</label>
                      		<select name="workYear" id="workYear" data-native-menu="true">
							</select>
							<div class="col_cv_alt" data-error="workYear"></div>
              </div>        
                      <label class="trainee" for="highestEducation" text="<font color='red'>* </font>目前就读学历:"><font color="red">* </font>最高全日制学历:</label>
                      		<select name="highestEducation" id="highestEducation" data-native-menu="true">
							</select>
							<div class="col_cv_alt" data-error="highestEducation"></div>
                      <label class="trainee" for="highestDegree" text="<font color='red'>* </font>预计取得学位:"><font color="red">* </font>最高学位：</label>
                      		<select name="highestDegree" id="degree" data-native-menu="true">
							</select>
							<div class="col_cv_alt" data-error="highestDegree"></div>
                      <label for="beginSchoolDate"><font color="red">* </font>开始时间:</label>
                      		<input type="date" name="beginSchoolDate" id="beginSchoolDate">
                      		<div class="col_cv_alt" data-error="beginSchoolDate"></div>
                      <label class="trainee" for="graduateDate" text="<font color='red'>* </font>预计毕业时间:" ><font color="red">* </font>毕业时间:</label>
                      		<input type="date" name="graduateDate" id="graduateDate">
                      		<div class="col_cv_alt" data-error="graduateDate"></div>
                      <label class="trainee" for="school" text="<font color='red'>* </font>所在院校:"><font color="red">* </font>毕业院校：</label>
                      		<input type="text" name="school" id="school">
                      		<div class="col_cv_alt" data-error="school"></div>		
                      <label for="schoolType"><font color="red">* </font>院校类别：</label>
                      		<select name="schoolType" id="schoolType"  data-native-menu="true">
							</select>
							<div class="col_cv_alt" data-error="schoolType"></div>
					  <label for="major"><font color="red">* </font>专业：</label>
                      		<input type="text" name="major" id="major">
                      		<div class="col_cv_alt" data-error="major"></div>	
             <div class="CampusAndTrainee">         
                      <label for="ceeProvince"><font color='red'>* </font>高考省市：</label>
                      <div class="selectCity">
                      		<select class="prov" data-role="none"></select> 
							<div class="col_cv_alt" data-role="none" data-error="ceeProvince"></div>
							<input type="text" data-role="none" name="ceeProvince" id="ceeProvince" style="display:none;">
                      </div>
                      <label for="ceeYear"><font color='red'>* </font>高考年份：</label>
                      		<input type="text" class="my-date-year" data-role="datebox" name="ceeYear" id="ceeYear" >
                      		<div class="col_cv_alt" data-error="ceeYear"></div>
                      <label for="ceeScore"><font color='red'>* </font>高考分数：</label>
                      		<input type="text" name="ceeScore" id="ceeScore">
                      		<div class="col_cv_alt" data-error="ceeScore"></div>
					  <label for="isFirstLine"><font color='red'>* </font>是否一本分数线以上:</label>
						        <input type="radio" data-role="none" name="isFirstLine" id="t" value="true">
						                 是
						        <input type="radio" data-role="none" name="isFirstLine" id="f" value="false">
						                 否	
						        <div class="col_cv_alt" data-error="isFirstLine"></div>
                      <label for="artsOrScience"><font color='red'>* </font>文理科：</label>
                      		<select name="artsOrScience" id="artsOrScience" data-native-menu="true">
							</select>
							<div class="col_cv_alt" data-error="artsOrScience"></div>
                      <label for="admissionOrder"><font color='red'>* </font>录取批次：</label>
                      		<select name="admissionOrder" id="admissionOrder" data-native-menu="true">
							</select>
							<div class="col_cv_alt" data-error="admissionOrder"></div>
              </div> 
                      <label for="emergencyContact"><font color="red">* </font>紧急联系人:</label>
                      		<input type="text" name="emergencyContact" id="emergencyContact">
							<div class="col_cv_alt" data-error="emergencyContact"></div>
                      <label for="emergencyMobile"><font color="red">* </font>紧急联系人电话:</label>
                      		<input type="text" name="emergencyMobile" id="emergencyMobile">
							<div class="col_cv_alt" data-error="emergencyMobile"></div>
					  <label for="isRelativeHere"><font color="red">* </font>是否有亲友受雇与本公司：</label>
						    <input type="radio" data-role="none" name="isRelativeHere" id="t" value="true">
						          是
						    <input type="radio" data-role="none" name="isRelativeHere" id="f" value="false">
						         否	
						    <div class="col_cv_alt" data-error="isRelativeHere"></div>		
                      <label for="currentResidence"><font color="red">* </font>现居住地址:</label>
                      <div class="selectCity">
                      		<select class="prov" data-role="none"></select> 
							<select class="city" data-role="none" disabled="disabled"></select>
							<select class="dist" data-role="none" disabled="disabled"></select>
							<input type="text" data-role="none" class="more" placeholder="____街道____号" style="">
							<div class="col_cv_alt" data-role="none" data-error="currentResidence"></div>
							<input type="text" data-role="none" name="currentResidence" id="currentResidence" style="display:none;">
                      </div>
                      <label for="lname"><font color="red">* </font>家庭住址：</label>
                      <div class="selectCity">
                      		<select class="prov" data-role="none"></select> 
							<select class="city" data-role="none" disabled="disabled"></select>
							<select class="dist" data-role="none" disabled="disabled"></select>
							<input type="text" data-role="none" class="more" placeholder="____街道____号" style="">
							<div class="col_cv_alt" data-role="none" data-error="familyResidence"></div>
							<input type="text" data-role="none" name="familyResidence" id="familyResidence" style="display:none;">
                      </div>
                      <label for="certificate">持证情况:</label>
                      		<textarea name="certificate" id="certificate" placeholder=""></textarea>
							<div class="col_cv_alt" data-error="certificate"></div>
                      <label for="hobby">爱好特长:</label>
	                      	<textarea name="hobby" id="hobby" placeholder=""></textarea>
							<div class="col_cv_alt" data-error="hobby"></div>
                      <label for="personality">性格特点：</label>
	                      	<textarea name="personality" id="info" placeholder=""></textarea>
							<div class="col_cv_alt" data-error="personality"></div>
                    </div> 
                    <div align="center">
	                    <div align="center" class='bgc'>
	                    	<a data-role="button" class='bgc'  href="#" onclick="save($(this))" url="wechatResume/updateResumeBase">保存</a>
	                	</div>
                	</div>  
                </form>  
            	</fieldset> 
            </div>           
       
            <div id="Education" data-role="collapsible">
                <h1><font color="red">* </font>教育经历(从最高学历填至本科或大专)</h1>
                <div id="education_forms"></div>
	            <div data-role="controlgroup" data-type="horizontal" align="right">
      				<a data-role="button"  href="#" data-icon="plus"   onclick="add($(this),'education')">添加</a>
      			</div> 
            </div>
            
            <div id="Work" data-role="collapsible">
                <h1><font color="red">* </font>工作经历(仅填写全职工作经历)</h1>
                <div id="work_forms"></div>
	            <div data-role="controlgroup" data-type="horizontal" align="right">
      				<a data-role="button"  href="#" data-icon="plus"  onclick="add($(this),'work')">添加</a>
      			</div> 
            </div>
            
            <div id="ForeignLanguage" data-role="collapsible">
                <h1>外语水平</h1>
                <div id="foreignLanguage_forms"></div>
	            <div data-role="controlgroup" data-type="horizontal" align="right">
      				<a data-role="button"  href="#" data-icon="plus"   onclick="add($(this),'foreignLanguage')">添加</a>
      			</div>     
            </div>
            
            <div id="Computer" data-role="collapsible">
                <h1>计算机技能</h1>
                <div id="computer_forms"></div>
	            <div data-role="controlgroup" data-type="horizontal" align="right">
      				<a data-role="button"  href="#" data-icon="plus"  onclick="add($(this),'computer')">添加</a>
      			</div>    
            </div>
            
            <div id="Practice" data-role="collapsible">
                <h1>实践活动(填写实习、社会实践及项目经历)</h1>
                <div id="practice_forms"></div>
	            <div data-role="controlgroup" data-type="horizontal" align="right">
      				<a data-role="button"  href="#" data-icon="plus"   onclick="add($(this),'practice')">添加</a>
      			</div> 
            </div>
                        
            <div id="StudentCadre" data-role="collapsible">
                <h1>学生干部(填写学生干部经历)</h1>
                <div id="studentCadre_forms"></div>
	            <div data-role="controlgroup" data-type="horizontal" align="right">
      				<a data-role="button"  href="#" data-icon="plus"   onclick="add($(this),'studentCadre')">添加</a>
      			</div> 
            </div>
            
            <div id="Award" data-role="collapsible">
                <h1>奖励记录(请填写在校或工作期间获奖情况)</h1>
                <div id="award_forms"></div>
	            <div data-role="controlgroup" data-type="horizontal" align="right">
      				<a data-role="button"  href="#" data-icon="plus"   onclick="add($(this),'award')">添加</a>
      			</div>   
            </div>
            
            <div id="Train" data-role="collapsible">
                <h1>培训经历(请填写正规培训机构培训信息)</h1>
                <div id="train_forms"></div>
	            <div data-role="controlgroup" data-type="horizontal" align="right">
      				<a data-role="button"  href="#" data-icon="plus"   onclick="add($(this),'train')">添加</a>
      			</div>
            </div>
            
            <div id="Family" data-role="collapsible">
                <h1><font color="red">* </font>家庭成员(请填写家庭和社会主要成员，父母必须填写)</h1>
                <div id="family_forms">
                </div>
	            <div data-role="controlgroup" data-type="horizontal" align="right">
      				<a data-role="button"  href="#" data-icon="plus"  onclick="add($(this),'family')">添加</a>
      			</div>
            </div>
 
            <div align="center">
              <a data-role="button" href="#" onclick="sumbit_resume()">提交</a>
            </div>
       </div>
       <div data-role="footer" data-position="fixed">
       </div>
   </div>
   </body>

<script>
var _dicts ;
var params = getUrlParam(location.search);

$(document).ready(function() {
	
	//$('input:jqmData(role="datebox")').mobiscroll().date();
	
	if(params!= null && params!= ""){
    	$("#recruit_title").html("我的简历-"+recruitType[params["recruitType"]]);
    }
	//显示控制
	if(params.recruitType=='trainee'){
		
		$("#Work").remove();
		$(".society").remove();
		$(".trainee").each(function(){
			if($(this).attr("text")){
				$(this).html($(this).attr("text"));
			}
		});
		
	}else if(params.recruitType=='campus'){
		
		$("#Work").remove();
		$(".society").remove();
		
	}else if(params.recruitType=='society'){
		
		$("#Practice").remove();
		$("#StudentCadre").remove();
		$(".CampusAndTrainee").remove();
		
	}
	//初始化时间插件
	//$form.find(".form_datetime").datetimepicker();
	//$form.find(".form_datetime_year").datetimepicker({"format":"yyyy","startView":"decade","minView":"decade"});
    //数据加载
    LoadBase(params);
    //照片加载
    $("#photoImg").attr("onerror","this.src='"+ baseUrl +"resources/images/pic_tx.jpg'");
    $("#photoImg").attr("src",baseUrl+"resume/phote/show?id="+params.id);
    $("#fileupload").attr("data-url",baseUrl+"resume/photo/upload?id="+params.id);
    
  //头像上传
	$('#fileupload').fileupload({
		dataType : 'json',
		done : function(e, data) {
			var message=data.result.message;
			if(message){
				showDialog({
					head:"提示",
					title:message,
					content:"",
					type:"back"
				});
				$("#photoImg").attr("src",baseUrl+"resume/phote/show?id="+params.id);
			}
		}
	});

});

   function LoadBase(param){
		$.ajax({
			url:baseUrl+"wechatResume/getResume",
			data:param,
			type:"post",
			success:function(text){
				if(text.success){
						var _data = text.data.resume;   //简历信息
						_dicts = text.data.dicts;   //所有字典
						_dicts.YesOrNo={"false":"否","true":"是"};
						    //初始化基本信息
							setData($("#baseForm"),_data);
						    //教育 
						    //educationList
						    if(_data.educationList && _data.educationList.length>0){
						    	setListData($("#Education"),_data.educationList,"education");
						    }
						    //工作 Work
						    //workList
						    if(_data.workList && _data.workList.length>0){
						    	setListData($("#Work"),_data.workList,'work');
						    }
						    //学生干部 StudentCadre
						    //studentCadreList
						    if(_data.studentCadreList && _data.studentCadreList.length>0){
						    	setListData($("#StudentCadre"),_data.studentCadreList,'studentCadre');
						    }
						    //奖励 Award
						    //awardList
						    if(_data.awardList && _data.awardList.length>0){
						    	setListData($("#Award"),_data.awardList,'award');
						    }
						    //外语 ForeignLanguage
						    //foreignLanguageList
						    if(_data.foreignLanguageList && _data.foreignLanguageList.length>0){
						    	setListData($("#ForeignLanguage"),_data.foreignLanguageList,'foreignLanguage');
						    }
						    //计算机 Computer
						    //computerList
						    if(_data.computerList && _data.computerList.length>0){
						    	setListData($("#Computer"),_data.computerList,"computer");
						    }
						    //家庭成员 Family
						    //familyList
						    if(_data.familyList && _data.familyList.length>0){
						    	setListData($("#Family"),_data.familyList,"family");
						    }
						    //实践活动Practice
						    //practiceList
						    if(_data.practiceList && _data.practiceList.length>0){
						    	setListData($("#Practice"),_data.practiceList,"practice");
						    }
						    //培训经历Train
						    //trainList
						    if(_data.trainList && _data.trainList.length>0){
						    	setListData($("#Train"),_data.trainList,"train");
						    }
						    //特殊处理
						    initSelectOthers();
						    
							//初始化省市区联动
							initSelectCity($("#baseForm"));
							
						    
				}else{
					if(text.message=="noLogin"){
						showDialog({
    						head:"提示",
    						title:"请登录后操作",
    						content:"",
    						href:"login.html",
    						type:"opens"
    					});
					}
			   }
			}
		});
   }
   
   /***
     * 初始化数据
     */
   function setData($Form,Data){
	   //初始化下拉选框
	   $Form.find("select").each(function(){
		   var _id = $(this).attr("id");
		   var _name = $(this).attr("id");
		   if(_name && _dicts[_name]){
			   InitSelect($(this),_dicts[_id],null);
		   }
	   });
	   //加载数据
	   $Form.autofill(Data);
	  
	   $Form.find(":input").each(function(){
		   var _name = $(this).attr("name") ;	  
		   if(_name){
			    if($(this).is("select")){
					   //下拉选项内容有变动需要重新加载
					   $(this).selectmenu(); 
					   $(this).selectmenu('refresh');
				}
		    };
	   });

   }
   
   /**
     *初始化select
     */
    function InitSelect($Select,Data,Value){
    	var _s = $Select;
    	_s.empty();//清空下拉框 
    	$("<option value=''>请选择</option>").appendTo(_s);
    	for(var key in Data){
    		$("<option value='"+ key +"'>"+ Data[key] +"</option>").appendTo(_s);
    	}
    	if(Value && Value!=''){
    		_s.attr("value",Value);//当前选中项 
    	}
    	//下拉选项内容有变动需要重新加载
		  _s.selectmenu(); 
		  _s.selectmenu('refresh');
    } 
   
   
   /**
	*
	*  信息保存
	*
	*/   
   
   
   function save(_this){
	   var form ;
	   var fieldset = _this.parent();;
	   for(var i=0;i<10;i++){
		   if(fieldset.is("fieldset")){
			   form = fieldset.find("form");
			   break;
		   }else{
			   fieldset = fieldset.parent(); 
		   }
	   }
	   
	   if(form.is("form")){
		   $.ajax({
			   url:baseUrl+_this.attr("url"),
			   data:form.serialize(),
			   type:"post",
			   success:function(text){
				   console.log(text);
				   if(text.success){
						showDialog({
    						head:"提示",
    						title:"保存成功",
    						content:"",
    						href:"",
    						type:"back"
    					});
					   form.find("input[name='id']").val(text.data);
				   }else if(text.error){
					   form.showError(text.error);
						showDialog({
    						head:"提示",
    						title:"表单信息有误",
    						content:"",
    						href:"",
    						type:"back"
    					});
				   }else{
						showDialog({
    						head:"提示",
    						title:"保存失败",
    						content:"",
    						href:"",
    						type:"back"
    					});
				   }
			   }
		   });
	   }else{
			showDialog({
				head:"提示",
				title:"保存异常",
				content:"",
				href:"",
				type:"back"
			});
	   }
	   
   }
   /***
   *
   *  删除信息
   *
   */
   function dele(_this){
	  if(confirm("确认删除？")){ 
		   var fieldset = _this.parent();;
		   for(var i=0;i<10;i++){
			   if(fieldset.is("fieldset")){
				   break;
			   }else{
				   fieldset = fieldset.parent(); 
			   }
		   }
		   if(fieldset.is("fieldset")){
			   var form = fieldset.find("form");
			   var id   = form.find("input[name='id']").val();
			   //删除数据
			   if(id>-1){
				   $.ajax({
					   url:baseUrl+_this.attr("url"),
					   data:form.serialize(),
					   type:"post",
					   success:function(text){
						   if(text.success){
							   //删除页面元素
							   fieldset.remove();
								showDialog({
									head:"提示",
									title:"删除成功",
									content:"",
									href:"",
									type:"back"
								});
						   }else{
								showDialog({
									head:"提示",
									title:"删除失败",
									content:"",
									href:"",
									type:"back"
								});
						   }
					   }
				   });
			   }else{
				   //删除页面元素
				   fieldset.remove();
			   }
		   }else{
				showDialog({
					head:"提示",
					title:"删除异常",
					content:"",
					href:"",
					type:"back"
				});
		   }
	  }
   }
   
    /***
	   *
	   * 新增
	   *
	   */
	  function add(_this,formName){
   		var $F = $(H[formName]);
   		$F.find("select").each(function(){
			   var _id = $(this).attr("id");
			   var _name = $(this).attr("id");
			   if(_name && _dicts[_name]){
				   InitSelect($(this),_dicts[_name],null);
			   }
		});
   		$F.find("input[name='resumeId']").val(params.id);
   		$F.find("input[name='recruitType']").val(params.recruitType);
   		$F.appendTo($("#"+formName+"_forms"));
   	  } 
  
   /****
     *
     *   初始化简历附属信息（多条）
     *
     */
   function setListData($obj,list,formName){
	   for(var i=0 ;i<list.length;i++){
		   var $F = $(H[formName]);
			setData($F.find("form"),list[i]);
			$F.appendTo($("#"+formName+"_forms"));
	    	
		}
   }
   
  
   /***
     * 简历提交
     **/
   
     function sumbit_resume(){
	   var resumeId = $("#resumeId").val();
	   $.ajax({
		   url:baseUrl+"/resume/submit",
		   data:{"id":params.id},
		   type:"post",
		   success:function(text){
				if(text.success){
					showDialog({
						head:"提示",
						title:"提交成功",
						content:"",
						href:"",
						type:"back"
					});
				}else if(text.message){
					showDialog({
						head:"提示",
						title:text.message,
						content:"",
						href:"",
						type:"back"
					});
				}
		   }
	   });
   }

   
 	$("body").on("change","#language",function(){
 		var value=$(this).find("option:selected").val();
		var $form = getPerParent($(this),"form");
 		var $input=$form.find("#language_others");
		if(value=="other"){
			$input.val("");
			$input.show();
		}else{
			$input.val(value);
			$input.hide();
		}
	});
 	
 	
 	//初始化选“其他”的下拉框
 	function initSelectOthers(){
 	 	$("#foreignLanguage_forms").find("form").each(function(){
 	 		var $form = $(this);
 	 		$form.find("#language_others").each(function(){
 	 			var $select ;
 	 			var $input = $(this);
 	 			$form.find("#language").each(function(){
 	 				$select = $(this);
 	 			});
 	 			var val = $input.val();
 	 			if(val){
 	 				var $option = $select.find("option[value='"+ val +"']");
 	 				if($option.length>0){
 	 					$select.val(val);
 	 				}else{
 	 					$select.val("other");
 	 					$input.show();
 	 				}
 	 		    	//下拉选项内容有变动需要重新加载
 	 			  	$select.selectmenu(); 
 	 			 	$select.selectmenu('refresh');
 	 			}
 	 		});
 	 	});
 	}

 	//获得最近的个指定类型的父元素
 	function getPerParent(_$,ParentType){
 		var $parent = _$.parent();;
		   for(var i=0;i<20;i++){
			   if($parent.is(ParentType)){
				   break;
			   }else{
				   $parent = $parent.parent(); 
			   }
		   }
		return $parent ;   
 	}
 	
 	
 	//省市区联动
 	$("body").on("change",".selectCity select",function(){
 		var $selectCity=$(this).parent(".selectCity");
 		var prov=$selectCity.find(".prov").val();
 		var city=$selectCity.find(".city").val();
 		var dist=$selectCity.find(".dist").val();
 		var value="";
 		if(prov){
 			value+=prov;
 			$selectCity.find(".more").show();
 		}
 		if(city){
 			value+=","+city;
 		}
 		if(dist){
 			value+=","+dist;
 		}else if($selectCity.is(":has(.more)")){
 			value+=",";
 		}
 		$selectCity.find("input[name]").val(value);
 	});
 	
 	

 	//省市区更多联动
 	$("body").on("change",".selectCity .more",function(){
 		//重新赋值
 		$(this).siblings(".dist").change();
 		var $input=$(this).siblings("input[name]");
 		var value=$input.val();
 		if(value){
 			$input.val(value+","+$(this).val());
 		}
 	});
 	
 	//初始化城市下拉
 	function initSelectCity($from){
 		$from.find(".selectCity").each(function(){
			var value=$(this).find("input[name]").val();
			var parts=value.split(",");
			var settings={url:"../cityselect/js/city.min.js",nodata:"none"};
			for(var i=0;i<parts.length;i++){
				var $more=$(this).find(".more");
				if(i==0){
					settings.prov=parts[i];
					$more.show();
				}else if(i==1){
					settings.city=parts[i];
				}else if(i==2){
					settings.dist=parts[i];
				}else if(i==3){
					$more.val(parts[i]);
				}
			}
			$(this).citySelect(settings);
		});
 	}

</script>
</html>